<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="前段时间重装系统 Windows7 之后，在其上安装 VirtualBox 却总是无法启动虚拟机。最初是根据经验对 VirtualBox 版本进行降级，但是没有效果。后来问谷子哥问到了答案，修复之。 因为"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Windows7 运行 VirtualBox 虚拟机的一则错误"><meta property="og:description" content="前段时间重装系统 Windows7 之后，在其上安装 VirtualBox 却总是无法启动虚拟机。最初是根据经验对 VirtualBox 版本进行降级，但是没有效果。后来问谷子哥问到了答案，修复之。 因为"><meta property="og:type" content="article"><meta property="og:url" content="http://i.am.simonkuang.org/posts/2016/05/14/Windows7-%E8%BF%90%E8%A1%8C-VirtualBox-%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E4%B8%80%E5%88%99%E9%94%99%E8%AF%AF/"><meta property="article:published_time" content="2016-05-14T21:20:45+00:00"><meta property="article:modified_time" content="2016-05-14T21:20:45+00:00"><title>Windows7 运行 VirtualBox 虚拟机的一则错误 | 流沙书斋</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.90625d9fbb472b5f34fb5ba5842114a94d178eb68035d6dd2a9154e8b9bb1849.css integrity="sha256-kGJdn7tHK180+1ulhCEUqU0XjraANdbdKpFU6Lm7GEk="><script defer src=/en.search.min.1e8240e6ae2811912e6fdad8b3c953ce11f3b0b2fd0ecfc2fe6c89126a8d4b72.js integrity="sha256-HoJA5q4oEZEub9rYs8lTzhHzsLL9Ds/C/myJEmqNS3I="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><script defer src=/custom.min.85e1dbc39b23671ffbf52bcb831b12735ade63896b28278cfb69b35d2c870ee9.js integrity="sha256-heHbw5sjZx/79SvLgxsSc1reY4lrKCeM+2mzXSyHDuk="></script><script src=//kit.fontawesome.com/e81509d074.js crossorigin=anonymous></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>流沙书斋</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/><i class="menu-item-icon fa fa-fw fa-home"></i>首页</a></li><li><a href=/posts/><i class="menu-item-icon fa fa-fw fa-blog"></i>博客</a></li><li><a href=/topics/><i class="menu-item-icon fa fa-fw fa-book"></i>专栏</a></li></ul><ul><li><a href=https://github.com/simonkuang target=_blank rel=noopener><i class="menu-item-icon fa fa-fw fa-github"></i>Github</a></li><li><a href=https://www.zhihu.com/people/simonkuang target=_blank rel=noopener><i class="menu-item-icon fab fa-fw fa-zhihu"></i>知乎</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Windows7 运行 VirtualBox 虚拟机的一则错误</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><h1><a href=/posts/2016/05/14/Windows7-%E8%BF%90%E8%A1%8C-VirtualBox-%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E4%B8%80%E5%88%99%E9%94%99%E8%AF%AF/>Windows7 运行 VirtualBox 虚拟机的一则错误</a></h1><h5>2016-05-14</h5><p><p>前段时间重装系统 Windows7 之后，在其上安装 VirtualBox 却总是无法启动虚拟机。最初是根据经验对 VirtualBox 版本进行降级，但是没有效果。后来问谷子哥问到了答案，修复之。</p><p>因为网上的各种答案均需要重启进安全系统或者 PE 系统，还需要自行搜原版的系统文件覆盖系统中现有的，一个不小心用了不恰当版本的文件替换，导致无法进入系统才是杯具。大家都知道 windows 各种 SP 众多，各 SP 之间的文件不一定是通用的，这个问题还是需要小心的。</p><p>而我的办法很简单，一句命令，一次重启，搞定（前提，你的系统没有被『优化 C 盘空间』，否则你还是折腾替换文件去吧）。</p><p>先说错误的提示。关键是下面这一句</p><blockquote><p>Unable to load R3 Module</p></blockquote><p>原因是：某些 Windows 的改良版本为了解决 Win7 第三方主题装不上的问题，把 uxtheme.dll 进行了『破解』，这种破解导致 VirtualBox 调用 WinAPI 失败。</p><p>解决思路：将 uxtheme.dll 恢复成原版的即可。网上的思路是利用重启到安全模式或者 PE 系统中进行文件替换，我的办法是用 windows 自身的 system file scan 工具来完成（只需正常重启一次）。</p><p>解决办法：</p><blockquote><p>1、打开『命令提示符』，执行下面的命令：
2、sfc /scanfile=%systemroot%\system32\uxtheme.dll
3、正常重启，启动虚拟机，搞定。</p></blockquote><p>当然，第三方主题应该是用不了。这个得失你得自己权衡。按说能玩儿虚拟机的主，对个把不产生生产力的主题，应该是可以放弃的。哈哈~~~</p></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents></nav></aside></main></body></html>