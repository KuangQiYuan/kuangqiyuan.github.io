<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="其实写这篇文章，心情不太痛快。hexo 是我找了好久才确定下来，能用 markdown 写 blog 的系统。之前试过的如 jekyll 太复杂，而且定制化程度太低，不灵活。刚开始用 hexo"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="hexo 又成了技术流的玩具"><meta property="og:description" content="其实写这篇文章，心情不太痛快。hexo 是我找了好久才确定下来，能用 markdown 写 blog 的系统。之前试过的如 jekyll 太复杂，而且定制化程度太低，不灵活。刚开始用 hexo"><meta property="og:type" content="article"><meta property="og:url" content="http://i.am.simonkuang.org/posts/2019/02/28/hexo-%E5%8F%88%E6%88%90%E4%BA%86%E6%8A%80%E6%9C%AF%E6%B5%81%E7%9A%84%E7%8E%A9%E5%85%B7/"><meta property="article:published_time" content="2019-02-28T21:21:53+00:00"><meta property="article:modified_time" content="2019-02-28T21:21:53+00:00"><title>hexo 又成了技术流的玩具 | 流沙书斋</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.ce74a2661479d34141b5c018b4f25ba8292b5adeca6de5d7a1b5c4de41c8f25d.css integrity="sha256-znSiZhR500FBtcAYtPJbqCkrWt7KbeXXobXE3kHI8l0="><script defer src=/en.search.min.e9e22635e70f6b266439835f5f310e0afdac100a8577f9068b5ae0e2f166ab97.js integrity="sha256-6eImNecPayZkOYNfXzEOCv2sEAqFd/kGi1rg4vFmq5c="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><script defer src=/custom.min.85e1dbc39b23671ffbf52bcb831b12735ade63896b28278cfb69b35d2c870ee9.js integrity="sha256-heHbw5sjZx/79SvLgxsSc1reY4lrKCeM+2mzXSyHDuk="></script><script src=//kit.fontawesome.com/e81509d074.js crossorigin=anonymous></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>流沙书斋</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/><i class="menu-item-icon fa fa-fw fa-home"></i>首页</a></li><li><a href=/posts/><i class="menu-item-icon fa fa-fw fa-blog"></i>博客</a></li><li><a href=/topics/><i class="menu-item-icon fa fa-fw fa-book"></i>专栏</a></li></ul><ul><li><a href=https://github.com/simonkuang target=_blank rel=noopener><i class="menu-item-icon fa fa-fw fa-github"></i>Github</a></li><li><a href=https://www.zhihu.com/people/simonkuang target=_blank rel=noopener><i class="menu-item-icon fab fa-fw fa-zhihu"></i>知乎</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>hexo 又成了技术流的玩具</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#问题一npm-依赖存在缺陷>问题一。npm 依赖存在缺陷</a></li><li><a href=#问题二插件的停更老化>问题二。插件的停更、老化</a></li><li><a href=#解决方法>解决方法</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1><a href=/posts/2019/02/28/hexo-%E5%8F%88%E6%88%90%E4%BA%86%E6%8A%80%E6%9C%AF%E6%B5%81%E7%9A%84%E7%8E%A9%E5%85%B7/>hexo 又成了技术流的玩具</a></h1><h5>2019-02-28</h5><div><a href=/tags/%E6%8A%80%E6%9C%AF/ class=tags>技术</a></div><p><p>其实写这篇文章，心情不太痛快。hexo 是我找了好久才确定下来，能用 markdown 写 blog 的系统。之前试过的如 jekyll 太复杂，而且定制化程度太低，不灵活。刚开始用 hexo 的时候发现它简直是尤物，轻便简洁，扩展性还不错，官方收录了
<a href=https://hexo.io/plugins/index.html>很多 plugins</a>，足够码农用了。</p><p>结果没过几年，hexo 也快成了技术流的玩具。</p><h2 id=问题一npm-依赖存在缺陷>问题一。npm 依赖存在缺陷
<a class=anchor href=#%e9%97%ae%e9%a2%98%e4%b8%80npm-%e4%be%9d%e8%b5%96%e5%ad%98%e5%9c%a8%e7%bc%ba%e9%99%b7>#</a></h2><p>首先是 <code>"hexo@3.8.0"</code> 某个依赖 <code>"hexo-fs@0.2.2"</code>，后者依赖 <code>"chokidar@1.2.7"</code>，而 chokidar 又依赖 <code>"fsevents@1.1.3"</code>。好了，最后这个 <code>"fsevents@1.1.3"</code> 是被 <em>deprecated</em> 的版本，包含原生库，已经不存在 binary 下载，从源码编译也会报错。错误的大意是跟 node 的版本不兼容。</p><p>下面我把这个关系链重新理一下。</p><pre><code class=language-mermaid data-lang=mermaid>graph LR;
    A[&quot;hexo@3.8.0&quot;]--&gt;B[&quot;hexo-fs@0.2.2&quot;];
    B--&gt;C[&quot;chokidar@1.2.7&quot;];
    C--&gt;D[&quot;fsevents@1.1.3&quot;];
    D--&gt;E[&quot;(HELL)&quot;];
</code></pre><p>除了上面的问题以外，大量已经停更的 plugins 依赖的 <code>"hexo-cli@1.0.3"</code> 等旧库，也多对 <code>"fsevents@1.1.3"</code> 存在间接依赖。</p><p>用一句话来说后果，<strong>在 MacOS 下，用 <code>hexo-cli new</code> + <code>npm i</code> 的方式，根本安装不上 hexo。</strong></p><h2 id=问题二插件的停更老化>问题二。插件的停更、老化
<a class=anchor href=#%e9%97%ae%e9%a2%98%e4%ba%8c%e6%8f%92%e4%bb%b6%e7%9a%84%e5%81%9c%e6%9b%b4%e8%80%81%e5%8c%96>#</a></h2><p>像上面提到的，停更的插件，其间接依赖的第三方库若是被废弃，插件本身也就不可用了。这是一种情况。</p><p>第二种情况，hexo 本身在发展，某些停更的第三方插件没有跟着做适配，结果是 hexo 的使用体验受到了影响。</p><p>第三种情况，最常见的。哪怕是官网列表中的插件，质量也是有高有低，对那些技术不灵光的用户实在麻烦。</p><h2 id=解决方法>解决方法
<a class=anchor href=#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95>#</a></h2><p>针对安装不上的问题。我也不知道怎么解决 :( 我用撞大运的办法，<code>hexo-cli new</code> 一个项目以后，手动修改 <code>package.json</code>，将 <code>"hexo@3.8.0"</code> 这个依赖指向自己 fork 的 <code>hexo</code> repo，这个 forked repo 里面已经修改了 <code>hexo-fs</code> 是指向一个 forked <code>hexo-cli</code> repo。最后在这个 forked hero-cli repo 里面，把对 <code>chokidar</code> 的引用上升到 <code>"chokidar@1.7.0"</code> 以后。</p><p>挺复杂的，对吧。不懂点开发，还真办不了。</p><p>针对插件停更、老化的问题，只有一个办法，就是自己 fork 做二次开发。项目的依赖中直接写上自己的 git repo。</p><p>别问我有没有现成的。我也很无奈。</p><p>PS：这就是 npm 生态带来的问题。left_pad 事件发生后，有人说 nodejs 程序员懒到『 连最简单的代码都不想写』，只想引用。我不太赞同这个评论的态度，不过 npm 社区的程序员的确是把代码复用做到比较极致的地步。</p><hr><p><em>UPDATE(2019-02-28)</em></p><p>发现在新 new 的项目里面，<code>"hexo@3.8.0"</code> 的发布版好像是依赖的 <code>"hexo-fs@0.2.3"</code>，已经升级到间接依赖 <code>"fsevents@1.2.7"</code>。</p><p>挺无语的。真的。还有点懵圈，没太搞懂。</p><p>昨天我可是 <code>rm -rf ./node_modules/* && npm i</code> 操作的，按说缓存应该没影响才对。如果是 npm 自己的 cache（我设置到了 ~/.npm/cache 目录），新 new 出来的项目应该也会受影响才对啊。</p><p>好吧，不折腾了。下次再遇到，所有缓存，全部清理得了。</p></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><ul><li><a href=#问题一npm-依赖存在缺陷>问题一。npm 依赖存在缺陷</a></li><li><a href=#问题二插件的停更老化>问题二。插件的停更、老化</a></li><li><a href=#解决方法>解决方法</a></li></ul></li></ul></nav></aside></main></body></html>